<script>
    $(document).ready(function(){
        $("select[name=transaction-interval]").change(function(){
            $(this).parents('form').submit();
        });
        $("input[name=transaction-date]").change(function(){
            $(this).parents('form').submit();
        });

        $("#transaction-form").on('submit', function(e) {
            e.preventDefault();

            var $this = $(this);

            var tr_interval = $("select[name=transaction-interval]").val();
            var tr_date = $("input[name=transaction-date]").val();

            if(tr_interval !== null && tr_date){

                $.ajax({
                    url: $this.attr('action'),
                    type: $this.attr('method'),
                    data: $this.serialize(),
                    success: function(data) {
                        var html = '';
                        $.each(data, function(i, val){
                            var created = new Date(val.CreatedAt.date);

                            if ( val.Refunded === false ) {
                                var refunded = '<button type="submit" class="form-submit-button btn btn-sm btn-default btn-primary"> {intl l="Rembourser " } <span class="glyphicon glyphicon-repeat"></span></button>';
                            } else {
                                var refunded = '{intl l="Rembours√© par :"} '+val.Refundedby;
                            }
                            html += val.refunded+'<tr><td>'+val.TransactionId+'</td><td>'+val.OrderId+'</td><td>'+val.Amount+'</td><td>'+val.CustomerId+'</td><td>'+val.firstname+' '+val.lastname+'</td><td>'+val.Clientemail+'</td><td>'+created.toLocaleString()+'</td><td>'+refunded+'</td></tr>'
                            ;
                        });
                        $("#list-transaction").html(html);
                    }

                });
            }
        });



    });
</script>